---
title: '文心一言百度人工智能AI大数据模型文心一言Python3.10接入.'
date: '2023/04/10 14:59:21'
categories:
   - 文心一言
tags:
   - 人工智能
toc_level: 3
version: 3
---

![cover](images/ai-01.png)

“文心”取自《文心雕龙》一书的开篇，作者刘勰在书中引述了一个古代典故：春秋时期，鲁国有一位名叫孔文子的大夫，他在学问上非常有造诣，但是他的儿子却不学无术，孔文子非常痛心。

一天，孔文子在山上遇到了一位神仙，神仙告诉他：“你的儿子之所以不学无术，是因为你没有给他灌输文心，让他懂得文学的魅力和意义。”孔文子听后深受启发，回家后开始给儿子灌输文学知识，儿子也逐渐对学问产生了兴趣，最终成为了一位有学问的人。因此，刘勰在书中将“文心”解释为“灌输文学知识的心灵”之意。

百度以“文心”命名自己的AI产品线，可见其对自己的中文处理能力是极为自信的，ERNIE3.0对标ChatGPT3.5/4.0，ERNIE-ViLG对标Stable-Diffusion，文心PLATO则可以理解为ChatGPT的embedding，可谓是野心勃勃。

### [](about:blank#%E6%96%87%E5%BF%83%E4%B8%80%E8%A8%80SDK%E5%BC%95%E5%85%A5 "文心一言SDK引入")文心一言SDK引入

百度目前已经开源文心一言的sdk工具包：

```
pip3 install --upgrade wenxin-api
```

和百度云产品线一样，安装好以后，需要去文心一言官网获取appkey和appsecret

![cover](images/wenxin.png)

随后编写请求逻辑：

```
import wenxin_api 
from wenxin_api.tasks.free_qa import FreeQA
wenxin_api.ak = "your ak" #输入您的API Key
wenxin_api.sk = "your sk" #输入您的Secret Key
input_dict = {
    "text": "问题：你好！\n回答：",
    "seq_len": 512,
    "topp": 0.5,
    "penalty_score": 1.2,
    "min_dec_len": 2,
    "min_dec_penalty_text": "。?：！[<S>]",
    "is_unidirectional": 0,
    "task_prompt": "qa",
    "mask_type": "paragraph"
}
requests = FreeQA.create(**input_dict)
print(requests)

```
```
{
  "code": 0,
  "msg": "success",
  "data": {
    "result": "你好！我是百度研发的知识增强大语言模型，能够与人对话互动，回答问题，协助创作，高效便捷地帮助你解决学习和工作中的问题。",
    "createTime": "2023-03-16 16:02:10",
    "requestId": "71a6efb46acbd64394374f44579a01eb",
    "text": "天为什么这么蓝",
    "taskId": 1000000,
    "status": 1 # 0表示生成中，1表示生成成功
  }
}
```

请求的参数含义请参照官方文档：

[https://wenxin.baidu.com/plato](https://wenxin.baidu.com/plato)

这里需要注意的是，虽然参数支持async异步，但那不是指请求的异步方式返回，换句话说，文心模型返回还是需要等待的，并不是ChatGPT那种流式返回模式。

### [](about:blank#%E6%96%87%E5%BF%83%E4%B8%80%E8%A8%80API%E8%B0%83%E7%94%A8 "文心一言API调用")文心一言API调用

文心一言SDK的功能有限，也不支持异步请求调用，如果需要定制化或者使用别的语言请求文心一言，需要提前发起Http请求获取token，这里我们使用异步请求库httpx:

```
pip3 install httpx
```

添加获取token逻辑：

```
class Winxin:

    def chat(self,text):
        input_dict = {
            "text": f"问题：{text}\n回答：",
            "seq_len": 512,
            "topp": 0.5,
            "penalty_score": 1.2,
            "min_dec_len": 2,
            "min_dec_penalty_text": "。?：！[<S>]",
            "is_unidirectional": 0,
            "task_prompt": "qa",
            "mask_type": "paragraph"
        }
        rst = FreeQA.create(**input_dict)
        print(rst)

    async def get_token(self):

        headers = {"Content-Type":"application/x-www-form-urlencoded"}

        async with httpx.AsyncClient() as client:
            resp = await client.post(f"https://wenxin.baidu.com/moduleApi/portal/api/oauth/token?grant_type=client_credentials&client_id={wenxin_api.ak}&client_secret={wenxin_api.sk}",headers=headers)
            result = resp.json()
            print(result)
```

异步调用文心一言接口的token:

```
if __name__ == '__main__':

    wx = Winxin()
    asyncio.run(wx.get_token())
```

程序返回：

```
{'code': 0, 'msg': 'success', 'data': '24.3f6a63545345ae6588ea86a353.86400000.1679123673218.92a99f8955c6f9ab2c438a5f31b5d73b-173001'}
```

### [](about:blank#%E6%80%BB%E7%BB%93 "总结")总结

产品力而言，ChatGPT珠玉在前，文心一言还有很长的路需要走。ChatGPT虽然是一座遥不可及的高峰，但是其他公司也无须放弃人工智能领域的研究，毕竟作为最老牌的中文搜索引擎，百度浸润几十年的中文处理能力，还是无人能出其右的。

  

